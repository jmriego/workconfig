local my_dir="$(dirname "$0")"
local -a precmd_functions
source "${my_dir}/prompt/prompt.zsh"
source "${my_dir}/virtualenv.zsh"

if ! (( $chpwd_functions[(I)workon_cwd] )); then
  chpwd_functions+=(workon_cwd)
fi

(( ${prompt_sections[(I)dir]} )) || source "${my_dir}/prompt/dir.zsh"

settermtitle() {
  settitle "$(hostname -s):$(echo_prompt_section dir)"
}
precmd_functions+=(settermtitle)

precmd() {
  eval "${precmd_functions}"
}

# enable partial folder completion
zstyle ':completion:*' completer _complete
zstyle ':completion:*' matcher-list '' 'm:{[:lower:][:upper:]}={[:upper:][:lower:]}' '+l:|=* r:|=*'
# mark choice in the completion menu
zstyle ':completion:*' menu select
autoload -Uz compinit
compinit

bindkey -v
bindkey '^p' up-line-or-search
bindkey '^n' down-line-or-search
bindkey "^R" history-incremental-search-backward
